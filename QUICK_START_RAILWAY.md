# Quick Start: Deploy Skyriting to Railway with GoDaddy Domain

## ðŸš€ Step-by-Step Guide

### Part 1: Fix Port Issue (DONE âœ…)
The port 5000 issue has been fixed. The server now handles port conflicts gracefully.

### Part 2: Deploy to Railway

#### 1. Create Railway Account & Project
1. Go to https://railway.app
2. Sign up/login (use GitHub for easy integration)
3. Click "New Project"
4. Select "Deploy from GitHub repo"
5. Choose your `skyriting_up` repository

#### 2. Add MongoDB Database
1. In Railway project, click "New"
2. Select "Database" â†’ "MongoDB"
3. Wait for MongoDB to provision
4. Click on MongoDB service â†’ "Variables" tab
5. Copy the `MONGO_URL` value (this is your `MONGODB_URI`)

#### 3. Configure Environment Variables
1. In your main service (not MongoDB), go to "Variables" tab
2. Add these variables:

```
MONGODB_URI=<paste-from-mongodb-service>
PORT=5000
NODE_ENV=production
JWT_SECRET=<generate-using-command-below>
GMAIL_USER=your-email@gmail.com
GMAIL_CLIENT_ID=your-gmail-client-id
GMAIL_CLIENT_SECRET=your-gmail-client-secret
GMAIL_REFRESH_TOKEN=your-gmail-refresh-token
FRONTEND_URL=https://your-app-name.railway.app
ADMIN_EMAIL=admin@skyriting.com
```

**Generate JWT_SECRET:**
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

#### 4. Deploy
1. Railway will automatically detect `railway.json` and start building
2. Watch the "Deployments" tab for progress
3. Once deployed, you'll get a URL like: `https://skyriting-production.up.railway.app`

### Part 3: Connect GoDaddy Domain

#### 1. Get Railway Domain
1. In Railway service, go to "Settings"
2. Scroll to "Domains" section
3. Note your Railway domain (e.g., `skyriting-production.up.railway.app`)

#### 2. Configure GoDaddy DNS

**Option A: CNAME (Recommended for subdomains)**
1. Log in to GoDaddy
2. Go to "My Products" â†’ Click "DNS" next to your domain
3. Click "Add" to create a new record:
   - **Type:** CNAME
   - **Name:** www (or @ for root domain)
   - **Value:** `skyriting-production.up.railway.app`
   - **TTL:** 600 seconds
4. Click "Save"

**Option B: For Root Domain (if CNAME doesn't work)**
1. In Railway, go to "Settings" â†’ "Domains"
2. Click "Add Custom Domain"
3. Enter your domain: `skyriting.com`
4. Railway will show you DNS records to add
5. In GoDaddy, add these records as shown by Railway

#### 3. Add Domain in Railway
1. In Railway service â†’ "Settings" â†’ "Domains"
2. Click "Add Custom Domain"
3. Enter: `skyriting.com` (or `www.skyriting.com`)
4. Railway will automatically provision SSL certificate (takes 5-10 minutes)

#### 4. Update FRONTEND_URL
1. In Railway Variables, update:
   ```
   FRONTEND_URL=https://skyriting.com
   ```
2. Railway will redeploy automatically

### Part 4: Verify Deployment

1. **Test API:** Visit `https://skyriting.com/api/health`
   - Should return: `{"status":"ok","message":"Skyriting API is running"}`

2. **Test Frontend:** Visit `https://skyriting.com`
   - Should show your Skyriting homepage

3. **Initialize Admin:**
   - Visit `https://skyriting.com/admin/login`
   - Or use Railway Shell to run: `cd project/backend && npm run init-admin`

## ðŸ“‹ Environment Variables Reference

Create these in Railway (Service â†’ Variables):

| Variable | Value | Notes |
|----------|-------|-------|
| `MONGODB_URI` | From MongoDB service | Auto-generated by Railway |
| `PORT` | `5000` | Railway sets this automatically |
| `NODE_ENV` | `production` | |
| `JWT_SECRET` | Random string | Generate with: `node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"` |
| `GMAIL_USER` | Your Gmail | |
| `GMAIL_CLIENT_ID` | From Google Cloud | Get from Google Cloud Console |
| `GMAIL_CLIENT_SECRET` | From Google Cloud | Get from Google Cloud Console |
| `GMAIL_REFRESH_TOKEN` | From Google OAuth | Generate using OAuth2 Playground |
| `FRONTEND_URL` | `https://skyriting.com` | Your domain |
| `ADMIN_EMAIL` | `admin@skyriting.com` | Your admin email |

## ðŸ”§ Troubleshooting

### Build Fails
- Check Railway logs
- Ensure Node.js version >= 18
- Verify all dependencies in `package.json`

### Domain Not Working
- Wait 24-48 hours for DNS propagation
- Check DNS records match Railway requirements
- Verify SSL certificate is active (green lock in browser)

### MongoDB Connection Error
- Verify `MONGODB_URI` is correct
- Check MongoDB service is running
- Ensure MongoDB allows Railway IPs

### Port Already in Use
- Railway handles this automatically
- The server is configured to use `process.env.PORT`

## ðŸ“š Additional Resources

- **Railway Docs:** https://docs.railway.app
- **Railway Discord:** https://discord.gg/railway
- **Detailed Guide:** See `RAILWAY_DEPLOYMENT.md`

## âœ… Post-Deployment Checklist

- [ ] API health check works
- [ ] Frontend loads correctly
- [ ] Custom domain active
- [ ] SSL certificate active (HTTPS)
- [ ] Admin user initialized
- [ ] Email service tested
- [ ] All pages accessible

---

**Your Skyriting platform is now live! ðŸŽ‰**

Visit: `https://skyriting.com`
